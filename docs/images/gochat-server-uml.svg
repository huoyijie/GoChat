<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="1113px" preserveAspectRatio="none" style="width:1279px;height:1113px;background:#FFFFFF;" version="1.1" viewBox="0 0 1279 1113" width="1279px" zoomAndPan="magnify"><defs/><g><!--MD5=[979da56a7f83e2393dc758167ae295d0]
cluster Server--><g id="cluster_Server"><polygon fill="none" points="16,16,26,6,1262,6,1262,1086,1252,1096,16,1096,16,16" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="1252" x2="1262" y1="16" y2="6"/><line style="stroke:#181818;stroke-width:1.0;" x1="16" x2="1252" y1="16" y2="16"/><line style="stroke:#181818;stroke-width:1.0;" x1="1252" x2="1252" y1="16" y2="1096"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="45" x="612.5" y="35.2399">Server</text></g><!--MD5=[e80bd461753d6c5ec111731420959425]
cluster Main--><g id="cluster_Main"><path d="M42.5,58 L76.5,58 A3.75,3.75 0 0 1 79,60.5 L86,84.2719 L1235.5,84.2719 A2.5,2.5 0 0 1 1238,86.7719 L1238,1069.5 A2.5,2.5 0 0 1 1235.5,1072 L42.5,1072 A2.5,2.5 0 0 1 40,1069.5 L40,60.5 A2.5,2.5 0 0 1 42.5,58 " fill="none" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="40" x2="86" y1="84.2719" y2="84.2719"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="33" x="44" y="76.2399">Main</text></g><!--MD5=[a70b0d373322012744ecc119c63f921b]
cluster main--><g id="cluster_main"><rect fill="none" height="320" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:1.0;" width="1002" x="64" y="728"/><path d="M109,728 L109,741.2719 L99,751.2719 L64,751.2719 " fill="none" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="35" x="67" y="745.2399">main</text></g><!--MD5=[6a64d9b6ef4edbb86a95d50ac0359fcc]
cluster sendTo--><g id="cluster_sendTo"><rect fill="none" height="144" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:1.0;" width="527" x="397" y="783"/><path d="M458,783 L458,796.2719 L448,806.2719 L397,806.2719 " fill="none" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="51" x="400" y="800.2399">sendTo</text></g><!--MD5=[dec65acb061c0ad7eb693bd0c7daa717]
cluster storage--><g id="cluster_storage"><rect fill="none" height="245" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:1.0;" width="330" x="782" y="113"/><path d="M844,113 L844,126.2719 L834,136.2719 L782,136.2719 " fill="none" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="52" x="785" y="130.2399">storage</text></g><!--MD5=[b35085e655f6f77dc58da564414b09f3]
cluster sqlite--><g id="cluster_sqlite"><path d="M822,178 C822,168 951,168 951,168 C951,168 1080,168 1080,178 L1080,316 C1080,326 951,326 951,326 C951,326 822,326 822,316 L822,178 " fill="none" style="stroke:#181818;stroke-width:1.0;"/><path d="M822,178 C822,188 951,188 951,188 C951,188 1080,188 1080,178 " fill="none" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="38" x="932" y="206.2399">sqlite</text></g><!--MD5=[9f8b0a80be7f5605175382d0979b4d41]
cluster biz--><g id="cluster_biz"><path d="M251.5,418 L272.5,418 A3.75,3.75 0 0 1 275,420.5 L282,444.2719 L1094.5,444.2719 A2.5,2.5 0 0 1 1097,446.7719 L1097,673.5 A2.5,2.5 0 0 1 1094.5,676 L251.5,676 A2.5,2.5 0 0 1 249,673.5 L249,420.5 A2.5,2.5 0 0 1 251.5,418 " fill="none" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="249" x2="282" y1="444.2719" y2="444.2719"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="20" x="253" y="436.2399">biz</text></g><!--MD5=[c9d94c42c631f5b94428ae0d0a216cff]
entity poster--><g id="elem_poster"><rect fill="#F1F1F1" height="50.2719" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="82" x="317" y="260"/><rect fill="#F1F1F1" height="10" style="stroke:#181818;stroke-width:0.5;" width="15" x="379" y="265"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="377" y="267"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="377" y="271"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="42" x="332" y="296.2399">poster</text></g><!--MD5=[0cc68753d5e3924938a71c36d5e43312]
entity push--><g id="elem_push"><rect fill="#F1F1F1" height="50.2719" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="74" x="76" y="260"/><rect fill="#F1F1F1" height="10" style="stroke:#181818;stroke-width:0.5;" width="15" x="130" y="265"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="128" y="267"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="128" y="271"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="34" x="91" y="296.2399">push</text></g><!--MD5=[e29493a8775effcafa538aa0485107d1]
entity auth--><g id="elem_auth"><rect fill="#F1F1F1" height="50.2719" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="71" x="1113.5" y="480"/><rect fill="#F1F1F1" height="10" style="stroke:#181818;stroke-width:0.5;" width="15" x="1164.5" y="485"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="1162.5" y="487"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="1162.5" y="491"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="31" x="1128.5" y="516.2399">auth</text></g><!--MD5=[53133b9ef51e4e7f3d2c6bacee8894bf]
entity signal--><g id="elem_signal"><rect fill="#F1F1F1" height="50.2719" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="133" x="80.5" y="853"/><rect fill="#F1F1F1" height="10" style="stroke:#181818;stroke-width:0.5;" width="15" x="193.5" y="858"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="191.5" y="860"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="191.5" y="864"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="93" x="95.5" y="889.2399">signalHandler</text></g><!--MD5=[f158fdd1bbef6b21c8becc7fbd7a9f6d]
entity handlePush--><g id="elem_handlePush"><rect fill="#F1F1F1" height="50.2719" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="121" x="248.5" y="853"/><rect fill="#F1F1F1" height="10" style="stroke:#181818;stroke-width:0.5;" width="15" x="349.5" y="858"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="347.5" y="860"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="347.5" y="864"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="81" x="263.5" y="889.2399">handlePush</text></g><!--MD5=[50fe5091060ff44cdbb86e2a998e009f]
entity handleConn--><g id="elem_handleConn"><rect fill="#F1F1F1" height="50.2719" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="122" x="636" y="982"/><rect fill="#F1F1F1" height="10" style="stroke:#181818;stroke-width:0.5;" width="15" x="738" y="987"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="736" y="989"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="736" y="993"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="82" x="651" y="1018.2399">handleConn</text></g><!--MD5=[b0ba84082f123e0495b2dfecce59962b]
entity recvFrom--><g id="elem_recvFrom"><rect fill="#F1F1F1" height="50.2719" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="101" x="948.5" y="853"/><rect fill="#F1F1F1" height="10" style="stroke:#181818;stroke-width:0.5;" width="15" x="1029.5" y="858"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="1027.5" y="860"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="1027.5" y="864"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="61" x="963.5" y="889.2399">recvFrom</text></g><!--MD5=[25c7ae5b566d5acd101d1664212f53f7]
entity send packet--><g id="elem_send packet"><rect fill="#F1F1F1" height="50.2719" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="121" x="440.5" y="853"/><rect fill="#F1F1F1" height="10" style="stroke:#181818;stroke-width:0.5;" width="15" x="541.5" y="858"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="539.5" y="860"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="539.5" y="864"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="81" x="455.5" y="889.2399">send packet</text></g><!--MD5=[c87c2b7496467e0959453e94265263f0]
entity push notify--><g id="elem_push notify"><rect fill="#F1F1F1" height="50.2719" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="115" x="596.5" y="853"/><rect fill="#F1F1F1" height="10" style="stroke:#181818;stroke-width:0.5;" width="15" x="691.5" y="858"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="689.5" y="860"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="689.5" y="864"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="75" x="611.5" y="889.2399">push notify</text></g><!--MD5=[2a86cc08a2853bd02d33e8cb4d6ebeba]
entity forward message--><g id="elem_forward message"><rect fill="#F1F1F1" height="50.2719" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="153" x="746.5" y="853"/><rect fill="#F1F1F1" height="10" style="stroke:#181818;stroke-width:0.5;" width="15" x="879.5" y="858"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="877.5" y="860"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="877.5" y="864"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="113" x="761.5" y="889.2399">forward message</text></g><!--MD5=[c8bd106169e92d1cec7d5e24ed4a2f44]
entity acc--><g id="elem_acc"><rect fill="#F1F1F1" height="50.2719" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="94" x="970" y="260"/><rect fill="#F1F1F1" height="10" style="stroke:#181818;stroke-width:0.5;" width="15" x="1044" y="265"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="1042" y="267"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="1042" y="271"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="54" x="985" y="296.2399">Account</text></g><!--MD5=[17aeb1e8b66d9b8c8203da36818275cd]
entity msg--><g id="elem_msg"><rect fill="#F1F1F1" height="50.2719" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="97" x="837.5" y="260"/><rect fill="#F1F1F1" height="10" style="stroke:#181818;stroke-width:0.5;" width="15" x="914.5" y="265"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="912.5" y="267"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="912.5" y="271"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="57" x="852.5" y="296.2399">Message</text></g><!--MD5=[21ab09ffd5d05f413c587b952aee3778]
entity base--><g id="elem_base"><rect fill="#F1F1F1" height="50.2719" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="72" x="546" y="480"/><rect fill="#F1F1F1" height="10" style="stroke:#181818;stroke-width:0.5;" width="15" x="598" y="485"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="596" y="487"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="596" y="491"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="32" x="561" y="516.2399">base</text></g><!--MD5=[388f72378e697285ab83d1e46414999a]
entity signup--><g id="elem_signup"><rect fill="#F1F1F1" height="50.2719" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="86" x="878" y="610"/><rect fill="#F1F1F1" height="10" style="stroke:#181818;stroke-width:0.5;" width="15" x="944" y="615"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="942" y="617"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="942" y="621"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="46" x="893" y="646.2399">signup</text></g><!--MD5=[7d31e0ad99682b9efa7ed3dbba05f561]
entity signin--><g id="elem_signin"><rect fill="#F1F1F1" height="50.2719" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="81" x="999.5" y="610"/><rect fill="#F1F1F1" height="10" style="stroke:#181818;stroke-width:0.5;" width="15" x="1060.5" y="615"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="1058.5" y="617"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="1058.5" y="621"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="41" x="1014.5" y="646.2399">signin</text></g><!--MD5=[ad6378801ae606b1e3035f68e044a3c5]
entity valtoken--><g id="elem_valtoken"><rect fill="#F1F1F1" height="50.2719" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="102" x="741" y="610"/><rect fill="#F1F1F1" height="10" style="stroke:#181818;stroke-width:0.5;" width="15" x="823" y="615"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="821" y="617"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="821" y="621"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="62" x="756" y="646.2399">val-token</text></g><!--MD5=[5f2f9dbbee692058d60489180693f774]
entity users--><g id="elem_users"><rect fill="#F1F1F1" height="50.2719" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="76" x="265" y="610"/><rect fill="#F1F1F1" height="10" style="stroke:#181818;stroke-width:0.5;" width="15" x="321" y="615"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="319" y="617"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="319" y="621"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="36" x="280" y="646.2399">users</text></g><!--MD5=[84ae9521e4814f8fac0332d6505248ce]
entity recvmsg--><g id="elem_recvmsg"><rect fill="#F1F1F1" height="50.2719" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="100" x="606" y="610"/><rect fill="#F1F1F1" height="10" style="stroke:#181818;stroke-width:0.5;" width="15" x="686" y="615"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="684" y="617"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="684" y="621"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="60" x="621" y="646.2399">recv-msg</text></g><!--MD5=[5c93a0072bce6ed02aef3e9e89bf67d4]
entity ping--><g id="elem_ping"><rect fill="#F1F1F1" height="50.2719" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="70" x="501" y="610"/><rect fill="#F1F1F1" height="10" style="stroke:#181818;stroke-width:0.5;" width="15" x="551" y="615"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="549" y="617"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="549" y="621"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="30" x="516" y="646.2399">ping</text></g><!--MD5=[2d7e746ef1b44ec36bf76a555e860c25]
entity signout--><g id="elem_signout"><rect fill="#F1F1F1" height="50.2719" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="90" x="376" y="610"/><rect fill="#F1F1F1" height="10" style="stroke:#181818;stroke-width:0.5;" width="15" x="446" y="615"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="444" y="617"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="444" y="621"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="50" x="391" y="646.2399">signout</text></g><!--MD5=[85a3dfef220902550057226e9b8bc6d3]
reverse link base to signup--><g id="link_base_signup"><path d="M622.91,530.37 C654.73,545.83 665.18,546.07 696,560 C714.11,568.18 717.33,573.19 736,580 C789.68,599.57 806.56,592.68 861,610 C866.45,611.73 872.11,613.73 877.68,615.82 " fill="none" id="base-backto-signup" style="stroke:#181818;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#181818" points="618.05,527.97,624.3401,535.5485,622.5307,530.1889,627.8903,528.3794,618.05,527.97" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[4d04923f9ecc0a34362fd2238baf1df9]
reverse link base to signin--><g id="link_base_signin"><path d="M623.03,530.32 C666.85,548.39 684.09,538.75 725,560 C737.63,566.56 736.9,574.44 750,580 C845.69,620.65 881.54,583.22 982,610 C987.69,611.52 993.55,613.46 999.27,615.58 " fill="none" id="base-backto-signin" style="stroke:#181818;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#181818" points="618.42,528.36,625.1356,535.5642,623.0209,530.3175,628.2676,528.2028,618.42,528.36" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[c7dfef0b46506e6bb65f933882631541]
reverse link base to valtoken--><g id="link_base_valtoken"><path d="M622.58,530.73 C660.03,553.56 715.32,587.26 752.45,609.89 " fill="none" id="base-backto-valtoken" style="stroke:#181818;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#181818" points="618.1,528,623.708,536.0963,622.371,530.5997,627.8676,529.2627,618.1,528" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[a8ea737b024d57f1fcc8c53f2460accc]
reverse link base to users--><g id="link_base_users"><path d="M541.14,530.24 C514.05,542.87 401.26,591.62 341.07,617.59 " fill="none" id="base-backto-users" style="stroke:#181818;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#181818" points="545.93,527.93,536.086,528.2388,541.4269,530.1029,539.5627,535.4438,545.93,527.93" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[53a7403789f9528755aa855458d83726]
reverse link base to recvmsg--><g id="link_base_recvmsg"><path d="M598.46,534.47 C611.49,557.01 629.51,588.18 641.89,609.6 " fill="none" id="base-backto-recvmsg" style="stroke:#181818;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#181818" points="595.92,530.08,596.9574,539.8741,598.4207,534.4097,603.885,535.873,595.92,530.08" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[c9739819fb4c0f724975792ce1da0299]
reverse link base to ping--><g id="link_base_ping"><path d="M571.57,535.03 C563.48,557.53 552.4,588.36 544.77,609.6 " fill="none" id="base-backto-ping" style="stroke:#181818;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#181818" points="573.35,530.08,566.5464,537.2012,571.662,534.7864,574.0767,539.902,573.35,530.08" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[7e5b31dc44e4bb9728f45e9c344f5dab]
reverse link base to signout--><g id="link_base_signout"><path d="M547.59,533.36 C519.04,556.06 478.81,588.04 451.42,609.81 " fill="none" id="base-backto-signout" style="stroke:#181818;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#181818" points="551.72,530.08,542.1867,532.5533,547.8073,533.193,547.1676,538.8136,551.72,530.08" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[352e83209bba9db3598c027370aaf685]
reverse link auth to valtoken--><g id="link_auth_valtoken"><path d="M1108.62,526.14 C1104.75,527.61 1100.84,528.93 1097,530 C1038.19,546.33 873.1,523.75 824,560 C808.12,571.72 800.03,592.98 795.96,609.71 " fill="none" id="auth-backto-valtoken" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="1113.49,524.21,1103.6492,523.8125,1108.8427,526.0546,1106.6006,531.2482,1113.49,524.21" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="129" x="825" y="576.08">parse/generate token</text></g><!--MD5=[eb14e39999df375d0c0b421959112c6d]
reverse link auth to signup--><g id="link_auth_signup"><path d="M1108.42,525.52 C1104.59,527.12 1100.75,528.64 1097,530 C1048.96,547.44 1029.38,532.98 986,560 C965.68,572.66 948.14,593.6 936.43,609.98 " fill="none" id="auth-backto-signup" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="1113.24,523.45,1103.3924,523.2928,1108.6391,525.4075,1106.5244,530.6542,1113.24,523.45" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="91" x="987" y="576.08">generate token</text></g><!--MD5=[23a67309095ee8c636f3616d70ba5274]
reverse link auth to signin--><g id="link_auth_signin"><path d="M1125.24,533.9 C1106,556.49 1079.17,588 1060.78,609.6 " fill="none" id="auth-backto-signin" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="1128.5,530.08,1119.6229,534.3459,1125.2613,533.8893,1125.7179,539.5277,1128.5,530.08" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="91" x="1102" y="576.08">generate token</text></g><!--MD5=[cdf4f4adb969f06d8d69831c69074150]
reverse link poster to base--><g id="link_poster_base"><path d="M404.19,307.49 C445.15,328.56 504.18,364.18 542,410 C559.05,430.65 569.9,459.65 575.94,479.96 " fill="none" id="poster-backto-base" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="399.28,304.99,405.4826,312.6404,403.7349,307.2603,409.115,305.5126,399.28,304.99" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="127" x="535" y="398.08">send packet to client</text></g><!--MD5=[44903f73778e62b74d038ac952d159be]
reverse link push to base--><g id="link_push_base"><path d="M154.51,307.27 C191.99,326.05 248.95,353.56 300,374 C336.53,388.63 345.33,394.72 384,402 C401.27,405.25 527.59,399.94 542,410 C564.83,425.94 574.7,457.68 578.92,479.85 " fill="none" id="push-backto-base" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="150.03,305.02,156.2813,312.6306,154.4993,307.2618,159.8681,305.4798,150.03,305.02" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123" x="385" y="398.08">push notify to client</text></g><!--MD5=[ef54b8d0a00d977adccbe28ebab4a8b1]
reverse link storage to base--><g id="link_storage_base"><path d="M794.2841,358.0655 C794.2389,358.2055 794.1931,358.3453 794.1469,358.4848 C793.777,359.6014 793.3754,360.7054 792.9404,361.7945 C791.2003,366.1508 788.925,370.2688 786,374 C758.85,408.64 734.13,393.21 691,402 C675.87,405.08 634.36,400.76 622,410 C599.84,426.57 589.83,457.85 585.4,479.76 " fill="none" id="storage-backto-base" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="794.2841,358.0655,787.7093,365.3985,792.7459,362.823,795.3213,367.8596,794.2841,358.0655" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[6f4ac1fa9f47e408f7a92aaf9af36d51]
reverse link signup to recvFrom--><g id="link_signup_recvFrom"><path d="M930.46,665.22 C946.03,713.33 976.77,808.31 991.19,852.86 " fill="none" id="signup-backto-recvFrom" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="928.91,660.43,927.8817,670.225,930.4525,665.1861,935.4914,667.757,928.91,660.43" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[4863403c2f83a9adbfd090d9e72a1d13]
reverse link signin to recvFrom--><g id="link_signin_recvFrom"><path d="M1034.98,665.51 C1026.78,713.71 1010.67,808.4 1003.11,852.86 " fill="none" id="signin-backto-recvFrom" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="1035.84,660.43,1030.3801,668.6269,1034.9972,665.3585,1038.2657,669.9755,1035.84,660.43" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[b3096730490b871ce0952f706e84219f]
reverse link valtoken to recvFrom--><g id="link_valtoken_recvFrom"><path d="M830.46,663.04 C840.37,669.93 851.05,677.29 861,684 C885.22,700.34 896.33,698.4 916,720 C952.75,760.34 978.36,819.95 990.66,852.9 " fill="none" id="valtoken-backto-recvFrom" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="826.26,660.12,831.357,668.5474,830.3622,662.9787,835.9309,661.9839,826.26,660.12" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[66e268c09d80148abaf74f2b4ba65b6a]
reverse link users to recvFrom--><g id="link_users_recvFrom"><path d="M330.43,663.74 C339,671.19 348.88,678.66 359,684 C401.33,706.35 415.6,705.3 463,712 C487.92,715.52 894.56,706.82 916,720 C963.94,749.46 985.71,816.71 994.26,852.89 " fill="none" id="users-backto-recvFrom" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="326.33,660.09,330.3971,669.0599,330.0663,663.4127,335.7134,663.0819,326.33,660.09" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[3209a8b179e1292512ca7763080f5e00]
reverse link recvmsg to recvFrom--><g id="link_recvmsg_recvFrom"><path d="M688.67,663.25 C699.37,670.99 711.68,678.73 724,684 C783.55,709.46 803.26,700.56 867,712 C888.72,715.9 898.08,707.12 916,720 C961.32,752.57 984.04,817.57 993.47,852.86 " fill="none" id="recvmsg-backto-recvFrom" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="684.5,660.17,689.3686,668.7314,688.5238,663.1379,694.1173,662.2932,684.5,660.17" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[507fd9627aaf565482741b9b9d1d0296]
reverse link ping to recvFrom--><g id="link_ping_recvFrom"><path d="M561.03,663.83 C569.24,671.44 578.87,678.97 589,684 C649.35,713.96 671.07,704.25 738,712 C757.67,714.28 899.28,709.41 916,720 C963.4,750.03 985.35,816.71 994.09,852.76 " fill="none" id="ping-backto-recvFrom" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="557.13,660.1,560.8689,669.2116,560.7432,663.5561,566.3987,663.4304,557.13,660.1" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[46881b5612622f761bb3e1df5afe6a0b]
reverse link signout to recvFrom--><g id="link_signout_recvFrom"><path d="M450.92,663.44 C460.82,671.19 472.31,678.9 484,684 C503.02,692.3 509.76,687.4 530,692 C561.97,699.26 568.58,707.1 601,712 C618.31,714.62 901.12,710.78 916,720 C963.82,749.65 985.64,816.81 994.23,852.94 " fill="none" id="signout-backto-recvFrom" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="446.78,660.12,451.2973,668.8718,450.6802,663.2487,456.3032,662.6315,446.78,660.12" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[6796fc84f0efce1352c6422b280f2dcc]
reverse link sendTo to handleConn--><g id="link_sendTo_handleConn"><path d="M413.1253,927.2616 C413.1723,927.3649 413.2195,927.468 413.267,927.5709 C413.647,928.3947 414.044,929.2101 414.4587,930.0152 C415.2881,931.6255 416.1885,933.1948 417.1658,934.7082 C419.1203,937.7352 421.3825,940.5387 424,943 C454.17,971.36 564.95,989.86 635.78,999.08 " fill="none" id="sendTo-backto-handleConn" style="stroke:#181818;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#181818" points="413.1253,927.2616,413.2118,937.1101,415.1961,931.8127,420.4935,933.797,413.1253,927.2616" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[9f4772d34caf59641f9b17468962bf6d]
reverse link recvFrom to handleConn--><g id="link_recvFrom_handleConn"><path d="M968.96,906.61 C953.96,919.19 935,933.39 916,943 C865.7,968.46 803.54,985.09 758.31,994.84 " fill="none" id="recvFrom-backto-handleConn" style="stroke:#181818;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#181818" points="973.09,903.11,963.6423,905.8921,969.2807,906.3487,968.8241,911.9871,973.09,903.11" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[09cf0ea4ab4e854253c4ebaf74c2aca6]
link poster to send packet--><g id="link_poster_send packet"><path d="M338.59,310.37 C319.06,334.43 287.67,371.88 258,402 C254.24,405.81 251.96,405.54 249,410 C205.38,475.72 180.17,503.16 198,580 C209.63,630.15 208.77,651.87 249,684 C291.12,717.64 313.91,702.7 367,712 C382.42,714.7 424.52,710.54 437,720 C477.46,750.68 492.45,811.31 497.93,847.59 " fill="none" id="poster-to-send packet" style="stroke:#181818;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#181818" points="498.67,852.76,501.3417,843.2804,497.9549,847.8114,493.4239,844.4246,498.67,852.76" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="49" x="199" y="576.08">channel</text></g><!--MD5=[d146aff062c6c9cbaf209dcc0f03b086]
link push to handlePush--><g id="link_push_handlePush"><path d="M111.29,310.32 C108.45,361.55 105.78,483.77 136,580 C152.05,631.13 164.84,641.14 197,684 C210.21,701.6 218.41,701.95 231,720 C260.04,761.64 284.35,815.67 297.77,848.26 " fill="none" id="push-to-handlePush" style="stroke:#181818;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#181818" points="299.67,852.91,299.9527,843.0652,297.7713,848.2845,292.5519,846.1032,299.67,852.91" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="49" x="137" y="576.08">channel</text></g><!--MD5=[9982253eab351c5128528b4c63e1b587]
reverse link push notify to handlePush--><g id="link_push notify_handlePush"><path d="M647.76,847.91 C638.93,813.92 619.17,760.21 579,736 C506.68,692.41 461.91,693.39 389,736 C345.76,761.27 324.07,819.48 314.8,853 " fill="none" id="push notify-backto-handlePush" style="stroke:#181818;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#181818" points="648.99,852.77,650.681,843.0674,647.774,847.9201,642.9212,845.0131,648.99,852.77" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="49" x="471.5" y="708.08">channel</text></g><!--MD5=[c311c2052faa7e395e90c0592415fb94]
reverse link storage to forward message--><g id="link_storage_forward message"><path d="M808.0129,358.3943 C808.3587,358.9347 808.7111,359.4703 809.0703,360.0007 C809.7886,361.0615 810.534,362.1016 811.3075,363.1182 C814.4013,367.1845 817.9438,370.8738 822,374 C891.64,427.67 1156.73,345.06 1216,410 C1266.94,465.8 1247.24,511.21 1216,580 C1186.96,643.95 1160.21,653.36 1097,684 C1018.48,722.06 974.02,667.93 904,720 C859.45,753.13 837.41,817.89 828.31,853 " fill="none" id="storage-backto-forward message" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="808.0129,358.3943,809.4947,368.1311,810.7079,362.6059,816.2331,363.819,808.0129,358.3943" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[941790a04c2480138c33d3f6ab1fd219]
@startuml gochat
node "Server" {
    package "Main" {
        frame "main" {
            [signalHandler] as signal
            [handlePush] as handlePush
            [handleConn] as handleConn
            frame "sendTo" {
                [send packet]
                [push notify]
                [forward message]
            }
            [recvFrom] as recvFrom
        }
        [poster] as poster
        [push] as push
        frame "storage" {
            database "sqlite" {
                [Account] as acc
                [Message] as msg
            }
        }
        [auth] as auth

        folder "biz" {
            [base] as base
            [signup] as signup
            [signin] as signin
            [val-token] as valtoken
            [users] as users
            [recv-msg] as recvmsg
            [ping] as ping
            [signout] as signout
        }
    }
}

signup .up.> base
signin .up.> base
valtoken .up.> base
users .up.> base
recvmsg .up.> base
ping .up.> base
signout .up.> base

valtoken -up-> auth : parse/generate token
signup -up-> auth : generate token
signin -up-> auth : generate token

base -up-> poster : send packet to client
base -up-> push : push notify to client
base -up-> storage

recvFrom -up-> signup
recvFrom -up-> signin
recvFrom -up-> valtoken
recvFrom -up-> users
recvFrom -up-> recvmsg
recvFrom -up-> ping
recvFrom -up-> signout

handleConn .up.> sendTo
handleConn .up.> recvFrom

poster ..> [send packet] : channel
push ..> handlePush : channel
handlePush .left.> [push notify] : channel
[forward message] -left-> storage
@enduml

PlantUML version 1.2022.7(Tue Aug 23 01:01:30 CST 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: zh
Country: CN
--></g></svg>