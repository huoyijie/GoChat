<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="1027px" preserveAspectRatio="none" style="width:1239px;height:1027px;background:#FFFFFF;" version="1.1" viewBox="0 0 1239 1027" width="1239px" zoomAndPan="magnify"><defs/><g><!--MD5=[979da56a7f83e2393dc758167ae295d0]
cluster Server--><g id="cluster_Server"><path d="M8.5,6.532 L54.5,6.532 A3.75,3.75 0 0 1 57,9.032 L64,32.8039 L1201.5,32.8039 A2.5,2.5 0 0 1 1204,35.3039 L1204,1018.032 A2.5,2.5 0 0 1 1201.5,1020.532 L8.5,1020.532 A2.5,2.5 0 0 1 6,1018.032 L6,9.032 A2.5,2.5 0 0 1 8.5,6.532 " fill="none" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="6" x2="64" y1="32.8039" y2="32.8039"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="45" x="10" y="24.7719">Server</text></g><!--MD5=[a70b0d373322012744ecc119c63f921b]
cluster main--><g id="cluster_main"><rect fill="none" height="320" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:1.0;" width="1002" x="30" y="676.532"/><path d="M75,676.532 L75,689.8039 L65,699.8039 L30,699.8039 " fill="none" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="35" x="33" y="693.7719">main</text></g><!--MD5=[6a64d9b6ef4edbb86a95d50ac0359fcc]
cluster sendTo--><g id="cluster_sendTo"><rect fill="none" height="144" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:1.0;" width="527" x="363" y="731.532"/><path d="M424,731.532 L424,744.8039 L414,754.8039 L363,754.8039 " fill="none" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="51" x="366" y="748.7719">sendTo</text></g><!--MD5=[dec65acb061c0ad7eb693bd0c7daa717]
cluster storage--><g id="cluster_storage"><rect fill="none" height="245" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:1.0;" width="330" x="748" y="61.532"/><path d="M810,61.532 L810,74.8039 L800,84.8039 L748,84.8039 " fill="none" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="52" x="751" y="78.7719">storage</text></g><!--MD5=[b35085e655f6f77dc58da564414b09f3]
cluster sqlite--><g id="cluster_sqlite"><path d="M788,126.532 C788,116.532 917,116.532 917,116.532 C917,116.532 1046,116.532 1046,126.532 L1046,264.532 C1046,274.532 917,274.532 917,274.532 C917,274.532 788,274.532 788,264.532 L788,126.532 " fill="none" style="stroke:#181818;stroke-width:1.0;"/><path d="M788,126.532 C788,136.532 917,136.532 917,136.532 C917,136.532 1046,136.532 1046,126.532 " fill="none" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="38" x="898" y="154.7719">sqlite</text></g><!--MD5=[9f8b0a80be7f5605175382d0979b4d41]
cluster biz--><g id="cluster_biz"><path d="M217.5,366.532 L238.5,366.532 A3.75,3.75 0 0 1 241,369.032 L248,392.8039 L1060.5,392.8039 A2.5,2.5 0 0 1 1063,395.3039 L1063,622.032 A2.5,2.5 0 0 1 1060.5,624.532 L217.5,624.532 A2.5,2.5 0 0 1 215,622.032 L215,369.032 A2.5,2.5 0 0 1 217.5,366.532 " fill="none" style="stroke:#000000;stroke-width:1.5;"/><line style="stroke:#000000;stroke-width:1.5;" x1="215" x2="248" y1="392.8039" y2="392.8039"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="20" x="219" y="384.7719">biz</text></g><!--MD5=[c9d94c42c631f5b94428ae0d0a216cff]
entity poster--><g id="elem_poster"><rect fill="#F1F1F1" height="50.2719" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="82" x="283" y="208.532"/><path d="M310.3333,208.532 L310.3333,213.532 L303.3333,220.532 L283,220.532 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="42" x="298" y="244.7719">poster</text></g><!--MD5=[0cc68753d5e3924938a71c36d5e43312]
entity push--><g id="elem_push"><rect fill="#F1F1F1" height="50.2719" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="74" x="42" y="208.532"/><path d="M66.6667,208.532 L66.6667,213.532 L59.6667,220.532 L42,220.532 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="34" x="57" y="244.7719">push</text></g><!--MD5=[e29493a8775effcafa538aa0485107d1]
entity auth--><g id="elem_auth"><rect fill="#F1F1F1" height="50.2719" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="71" x="1079.5" y="428.532"/><path d="M1103.1667,428.532 L1103.1667,433.532 L1096.1667,440.532 L1079.5,440.532 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="31" x="1094.5" y="464.7719">auth</text></g><!--MD5=[53133b9ef51e4e7f3d2c6bacee8894bf]
entity signal--><g id="elem_signal"><rect fill="#F1F1F1" height="50.2719" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="133" x="46.5" y="801.532"/><rect fill="#F1F1F1" height="10" style="stroke:#181818;stroke-width:0.5;" width="15" x="159.5" y="806.532"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="157.5" y="808.532"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="157.5" y="812.532"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="93" x="61.5" y="837.7719">signalHandler</text></g><!--MD5=[f158fdd1bbef6b21c8becc7fbd7a9f6d]
entity handlePush--><g id="elem_handlePush"><rect fill="#F1F1F1" height="50.2719" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="121" x="214.5" y="801.532"/><rect fill="#F1F1F1" height="10" style="stroke:#181818;stroke-width:0.5;" width="15" x="315.5" y="806.532"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="313.5" y="808.532"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="313.5" y="812.532"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="81" x="229.5" y="837.7719">handlePush</text></g><!--MD5=[50fe5091060ff44cdbb86e2a998e009f]
entity handleConn--><g id="elem_handleConn"><rect fill="#F1F1F1" height="50.2719" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="122" x="602" y="930.532"/><rect fill="#F1F1F1" height="10" style="stroke:#181818;stroke-width:0.5;" width="15" x="704" y="935.532"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="702" y="937.532"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="702" y="941.532"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="82" x="617" y="966.7719">handleConn</text></g><!--MD5=[b0ba84082f123e0495b2dfecce59962b]
entity recvFrom--><g id="elem_recvFrom"><rect fill="#F1F1F1" height="50.2719" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="101" x="914.5" y="801.532"/><rect fill="#F1F1F1" height="10" style="stroke:#181818;stroke-width:0.5;" width="15" x="995.5" y="806.532"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="993.5" y="808.532"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="993.5" y="812.532"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="61" x="929.5" y="837.7719">recvFrom</text></g><!--MD5=[25c7ae5b566d5acd101d1664212f53f7]
entity send packet--><g id="elem_send packet"><rect fill="#F1F1F1" height="50.2719" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="121" x="406.5" y="801.532"/><rect fill="#F1F1F1" height="10" style="stroke:#181818;stroke-width:0.5;" width="15" x="507.5" y="806.532"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="505.5" y="808.532"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="505.5" y="812.532"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="81" x="421.5" y="837.7719">send packet</text></g><!--MD5=[c87c2b7496467e0959453e94265263f0]
entity push notify--><g id="elem_push notify"><rect fill="#F1F1F1" height="50.2719" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="115" x="562.5" y="801.532"/><rect fill="#F1F1F1" height="10" style="stroke:#181818;stroke-width:0.5;" width="15" x="657.5" y="806.532"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="655.5" y="808.532"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="655.5" y="812.532"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="75" x="577.5" y="837.7719">push notify</text></g><!--MD5=[2a86cc08a2853bd02d33e8cb4d6ebeba]
entity forward message--><g id="elem_forward message"><rect fill="#F1F1F1" height="50.2719" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="153" x="712.5" y="801.532"/><rect fill="#F1F1F1" height="10" style="stroke:#181818;stroke-width:0.5;" width="15" x="845.5" y="806.532"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="843.5" y="808.532"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="843.5" y="812.532"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="113" x="727.5" y="837.7719">forward message</text></g><!--MD5=[c8bd106169e92d1cec7d5e24ed4a2f44]
entity acc--><g id="elem_acc"><rect fill="#F1F1F1" height="50.2719" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="94" x="936" y="208.532"/><rect fill="#F1F1F1" height="10" style="stroke:#181818;stroke-width:0.5;" width="15" x="1010" y="213.532"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="1008" y="215.532"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="1008" y="219.532"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="54" x="951" y="244.7719">Account</text></g><!--MD5=[17aeb1e8b66d9b8c8203da36818275cd]
entity msg--><g id="elem_msg"><rect fill="#F1F1F1" height="50.2719" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="97" x="803.5" y="208.532"/><rect fill="#F1F1F1" height="10" style="stroke:#181818;stroke-width:0.5;" width="15" x="880.5" y="213.532"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="878.5" y="215.532"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="878.5" y="219.532"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="57" x="818.5" y="244.7719">Message</text></g><!--MD5=[21ab09ffd5d05f413c587b952aee3778]
entity base--><g id="elem_base"><rect fill="#F1F1F1" height="50.2719" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="72" x="512" y="428.532"/><rect fill="#F1F1F1" height="10" style="stroke:#181818;stroke-width:0.5;" width="15" x="564" y="433.532"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="562" y="435.532"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="562" y="439.532"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="32" x="527" y="464.7719">base</text></g><!--MD5=[388f72378e697285ab83d1e46414999a]
entity signup--><g id="elem_signup"><rect fill="#F1F1F1" height="50.2719" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="86" x="844" y="558.532"/><rect fill="#F1F1F1" height="10" style="stroke:#181818;stroke-width:0.5;" width="15" x="910" y="563.532"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="908" y="565.532"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="908" y="569.532"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="46" x="859" y="594.7719">signup</text></g><!--MD5=[7d31e0ad99682b9efa7ed3dbba05f561]
entity signin--><g id="elem_signin"><rect fill="#F1F1F1" height="50.2719" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="81" x="965.5" y="558.532"/><rect fill="#F1F1F1" height="10" style="stroke:#181818;stroke-width:0.5;" width="15" x="1026.5" y="563.532"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="1024.5" y="565.532"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="1024.5" y="569.532"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="41" x="980.5" y="594.7719">signin</text></g><!--MD5=[ad6378801ae606b1e3035f68e044a3c5]
entity valtoken--><g id="elem_valtoken"><rect fill="#F1F1F1" height="50.2719" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="102" x="707" y="558.532"/><rect fill="#F1F1F1" height="10" style="stroke:#181818;stroke-width:0.5;" width="15" x="789" y="563.532"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="787" y="565.532"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="787" y="569.532"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="62" x="722" y="594.7719">val-token</text></g><!--MD5=[5f2f9dbbee692058d60489180693f774]
entity users--><g id="elem_users"><rect fill="#F1F1F1" height="50.2719" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="76" x="231" y="558.532"/><rect fill="#F1F1F1" height="10" style="stroke:#181818;stroke-width:0.5;" width="15" x="287" y="563.532"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="285" y="565.532"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="285" y="569.532"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="36" x="246" y="594.7719">users</text></g><!--MD5=[84ae9521e4814f8fac0332d6505248ce]
entity recvmsg--><g id="elem_recvmsg"><rect fill="#F1F1F1" height="50.2719" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="100" x="572" y="558.532"/><rect fill="#F1F1F1" height="10" style="stroke:#181818;stroke-width:0.5;" width="15" x="652" y="563.532"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="650" y="565.532"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="650" y="569.532"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="60" x="587" y="594.7719">recv-msg</text></g><!--MD5=[5c93a0072bce6ed02aef3e9e89bf67d4]
entity ping--><g id="elem_ping"><rect fill="#F1F1F1" height="50.2719" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="70" x="467" y="558.532"/><rect fill="#F1F1F1" height="10" style="stroke:#181818;stroke-width:0.5;" width="15" x="517" y="563.532"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="515" y="565.532"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="515" y="569.532"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="30" x="482" y="594.7719">ping</text></g><!--MD5=[2d7e746ef1b44ec36bf76a555e860c25]
entity signout--><g id="elem_signout"><rect fill="#F1F1F1" height="50.2719" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="90" x="342" y="558.532"/><rect fill="#F1F1F1" height="10" style="stroke:#181818;stroke-width:0.5;" width="15" x="412" y="563.532"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="410" y="565.532"/><rect fill="#F1F1F1" height="2" style="stroke:#181818;stroke-width:0.5;" width="4" x="410" y="569.532"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="50" x="357" y="594.7719">signout</text></g><!--MD5=[85a3dfef220902550057226e9b8bc6d3]
reverse link base to signup--><g id="link_base_signup"><path d="M588.91,478.902 C620.73,494.362 631.18,494.602 662,508.532 C680.11,516.712 683.33,521.722 702,528.532 C755.68,548.102 772.56,541.212 827,558.532 C832.45,560.262 838.11,562.262 843.68,564.352 " fill="none" id="base-backto-signup" style="stroke:#181818;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#181818" points="584.05,476.502,590.3401,484.0805,588.5307,478.7209,593.8903,476.9114,584.05,476.502" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[4d04923f9ecc0a34362fd2238baf1df9]
reverse link base to signin--><g id="link_base_signin"><path d="M589.03,478.852 C632.85,496.922 650.09,487.282 691,508.532 C703.63,515.092 702.9,522.972 716,528.532 C811.69,569.182 847.54,531.752 948,558.532 C953.69,560.052 959.55,561.992 965.27,564.112 " fill="none" id="base-backto-signin" style="stroke:#181818;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#181818" points="584.42,476.892,591.1356,484.0962,589.0209,478.8495,594.2676,476.7348,584.42,476.892" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[c7dfef0b46506e6bb65f933882631541]
reverse link base to valtoken--><g id="link_base_valtoken"><path d="M588.58,479.262 C626.03,502.092 681.32,535.792 718.45,558.422 " fill="none" id="base-backto-valtoken" style="stroke:#181818;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#181818" points="584.1,476.532,589.708,484.6283,588.371,479.1317,593.8676,477.7947,584.1,476.532" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[a8ea737b024d57f1fcc8c53f2460accc]
reverse link base to users--><g id="link_base_users"><path d="M507.14,478.772 C480.05,491.402 367.26,540.152 307.07,566.122 " fill="none" id="base-backto-users" style="stroke:#181818;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#181818" points="511.93,476.462,502.086,476.7708,507.4269,478.6349,505.5627,483.9758,511.93,476.462" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[53a7403789f9528755aa855458d83726]
reverse link base to recvmsg--><g id="link_base_recvmsg"><path d="M564.46,483.002 C577.49,505.542 595.51,536.712 607.89,558.132 " fill="none" id="base-backto-recvmsg" style="stroke:#181818;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#181818" points="561.92,478.612,562.9574,488.406,564.4207,482.9417,569.885,484.405,561.92,478.612" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[c9739819fb4c0f724975792ce1da0299]
reverse link base to ping--><g id="link_base_ping"><path d="M537.57,483.562 C529.48,506.062 518.4,536.892 510.77,558.132 " fill="none" id="base-backto-ping" style="stroke:#181818;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#181818" points="539.35,478.612,532.5464,485.7332,537.662,483.3184,540.0767,488.434,539.35,478.612" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[7e5b31dc44e4bb9728f45e9c344f5dab]
reverse link base to signout--><g id="link_base_signout"><path d="M513.59,481.892 C485.04,504.592 444.81,536.572 417.42,558.342 " fill="none" id="base-backto-signout" style="stroke:#181818;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#181818" points="517.72,478.612,508.1867,481.0853,513.8073,481.725,513.1676,487.3456,517.72,478.612" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[352e83209bba9db3598c027370aaf685]
reverse link auth to valtoken--><g id="link_auth_valtoken"><path d="M1074.62,474.672 C1070.75,476.142 1066.84,477.462 1063,478.532 C1004.19,494.862 839.1,472.282 790,508.532 C774.12,520.252 766.03,541.512 761.96,558.242 " fill="none" id="auth-backto-valtoken" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="1079.49,472.742,1069.6492,472.3445,1074.8427,474.5866,1072.6006,479.7801,1079.49,472.742" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="129" x="791" y="524.612">parse/generate token</text></g><!--MD5=[eb14e39999df375d0c0b421959112c6d]
reverse link auth to signup--><g id="link_auth_signup"><path d="M1074.42,474.052 C1070.59,475.652 1066.75,477.172 1063,478.532 C1014.96,495.972 995.38,481.512 952,508.532 C931.68,521.192 914.14,542.132 902.43,558.512 " fill="none" id="auth-backto-signup" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="1079.24,471.982,1069.3924,471.8248,1074.6391,473.9395,1072.5244,479.1862,1079.24,471.982" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="91" x="953" y="524.612">generate token</text></g><!--MD5=[23a67309095ee8c636f3616d70ba5274]
reverse link auth to signin--><g id="link_auth_signin"><path d="M1091.24,482.432 C1072,505.022 1045.17,536.532 1026.78,558.132 " fill="none" id="auth-backto-signin" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="1094.5,478.612,1085.6229,482.8779,1091.2613,482.4213,1091.7179,488.0597,1094.5,478.612" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="91" x="1068" y="524.612">generate token</text></g><!--MD5=[cdf4f4adb969f06d8d69831c69074150]
reverse link poster to base--><g id="link_poster_base"><path d="M370.19,256.022 C411.15,277.092 470.18,312.712 508,358.532 C525.05,379.182 535.9,408.182 541.94,428.492 " fill="none" id="poster-backto-base" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="365.28,253.522,371.4826,261.1724,369.7349,255.7923,375.115,254.0446,365.28,253.522" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="127" x="501" y="346.612">send packet to client</text></g><!--MD5=[44903f73778e62b74d038ac952d159be]
reverse link push to base--><g id="link_push_base"><path d="M120.51,255.802 C157.99,274.582 214.95,302.092 266,322.532 C302.53,337.162 311.33,343.252 350,350.532 C367.27,353.782 493.59,348.472 508,358.532 C530.83,374.472 540.7,406.212 544.92,428.382 " fill="none" id="push-backto-base" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="116.03,253.552,122.2813,261.1626,120.4993,255.7938,125.8681,254.0118,116.03,253.552" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="123" x="351" y="346.612">push notify to client</text></g><!--MD5=[ef54b8d0a00d977adccbe28ebab4a8b1]
reverse link storage to base--><g id="link_storage_base"><path d="M760.2841,306.5975 C760.2389,306.7375 760.1931,306.8772 760.1469,307.0168 C759.777,308.1334 759.3754,309.2374 758.9404,310.3264 C757.2003,314.6828 754.925,318.8007 752,322.532 C724.85,357.172 700.13,341.742 657,350.532 C641.87,353.612 600.36,349.292 588,358.532 C565.84,375.102 555.83,406.382 551.4,428.292 " fill="none" id="storage-backto-base" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="760.2841,306.5975,753.7093,313.9305,758.7459,311.355,761.3213,316.3916,760.2841,306.5975" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[6f4ac1fa9f47e408f7a92aaf9af36d51]
reverse link signup to recvFrom--><g id="link_signup_recvFrom"><path d="M896.46,613.752 C912.03,661.862 942.77,756.842 957.19,801.392 " fill="none" id="signup-backto-recvFrom" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="894.91,608.962,893.8817,618.757,896.4525,613.7181,901.4914,616.289,894.91,608.962" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[4863403c2f83a9adbfd090d9e72a1d13]
reverse link signin to recvFrom--><g id="link_signin_recvFrom"><path d="M1000.98,614.042 C992.78,662.242 976.67,756.932 969.11,801.392 " fill="none" id="signin-backto-recvFrom" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="1001.84,608.962,996.3801,617.1589,1000.9972,613.8904,1004.2657,618.5075,1001.84,608.962" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[b3096730490b871ce0952f706e84219f]
reverse link valtoken to recvFrom--><g id="link_valtoken_recvFrom"><path d="M796.46,611.572 C806.37,618.462 817.05,625.822 827,632.532 C851.22,648.872 862.33,646.932 882,668.532 C918.75,708.872 944.36,768.482 956.66,801.432 " fill="none" id="valtoken-backto-recvFrom" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="792.26,608.652,797.357,617.0793,796.3622,611.5107,801.9309,610.5158,792.26,608.652" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[66e268c09d80148abaf74f2b4ba65b6a]
reverse link users to recvFrom--><g id="link_users_recvFrom"><path d="M296.43,612.272 C305,619.722 314.88,627.192 325,632.532 C367.33,654.882 381.6,653.832 429,660.532 C453.92,664.052 860.56,655.352 882,668.532 C929.94,697.992 951.71,765.242 960.26,801.422 " fill="none" id="users-backto-recvFrom" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="292.33,608.622,296.3971,617.5919,296.0663,611.9447,301.7134,611.6138,292.33,608.622" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[3209a8b179e1292512ca7763080f5e00]
reverse link recvmsg to recvFrom--><g id="link_recvmsg_recvFrom"><path d="M654.67,611.782 C665.37,619.522 677.68,627.262 690,632.532 C749.55,657.992 769.26,649.092 833,660.532 C854.72,664.432 864.08,655.652 882,668.532 C927.32,701.102 950.04,766.102 959.47,801.392 " fill="none" id="recvmsg-backto-recvFrom" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="650.5,608.702,655.3686,617.2634,654.5238,611.6699,660.1173,610.8252,650.5,608.702" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[507fd9627aaf565482741b9b9d1d0296]
reverse link ping to recvFrom--><g id="link_ping_recvFrom"><path d="M527.03,612.362 C535.24,619.972 544.87,627.502 555,632.532 C615.35,662.492 637.07,652.782 704,660.532 C723.67,662.812 865.28,657.942 882,668.532 C929.4,698.562 951.35,765.242 960.09,801.292 " fill="none" id="ping-backto-recvFrom" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="523.13,608.632,526.8689,617.7436,526.7432,612.0881,532.3987,611.9624,523.13,608.632" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[46881b5612622f761bb3e1df5afe6a0b]
reverse link signout to recvFrom--><g id="link_signout_recvFrom"><path d="M416.92,611.972 C426.82,619.722 438.31,627.432 450,632.532 C469.02,640.832 475.76,635.932 496,640.532 C527.97,647.792 534.58,655.632 567,660.532 C584.31,663.152 867.12,659.312 882,668.532 C929.82,698.182 951.64,765.342 960.23,801.472 " fill="none" id="signout-backto-recvFrom" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="412.78,608.652,417.2973,617.4038,416.6802,611.7807,422.3032,611.1635,412.78,608.652" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[6796fc84f0efce1352c6422b280f2dcc]
reverse link sendTo to handleConn--><g id="link_sendTo_handleConn"><path d="M379.1253,875.7936 C379.1723,875.8969 379.2195,876 379.267,876.1029 C379.647,876.9267 380.044,877.742 380.4587,878.5472 C381.2881,880.1574 382.1885,881.7267 383.1658,883.2402 C385.1203,886.2671 387.3825,889.0707 390,891.532 C420.17,919.892 530.95,938.392 601.78,947.612 " fill="none" id="sendTo-backto-handleConn" style="stroke:#181818;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#181818" points="379.1253,875.7936,379.2118,885.6421,381.1961,880.3447,386.4935,882.329,379.1253,875.7936" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[9f4772d34caf59641f9b17468962bf6d]
reverse link recvFrom to handleConn--><g id="link_recvFrom_handleConn"><path d="M934.96,855.142 C919.96,867.722 901,881.922 882,891.532 C831.7,916.992 769.54,933.622 724.31,943.372 " fill="none" id="recvFrom-backto-handleConn" style="stroke:#181818;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#181818" points="939.09,851.642,929.6423,854.4241,935.2807,854.8806,934.8241,860.519,939.09,851.642" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[09cf0ea4ab4e854253c4ebaf74c2aca6]
link poster to send packet--><g id="link_poster_send packet"><path d="M304.59,258.902 C285.06,282.962 253.67,320.412 224,350.532 C220.24,354.342 217.96,354.072 215,358.532 C171.38,424.252 146.17,451.692 164,528.532 C175.63,578.682 174.77,600.402 215,632.532 C257.12,666.172 279.91,651.232 333,660.532 C348.42,663.232 390.52,659.072 403,668.532 C443.46,699.212 458.45,759.842 463.93,796.122 " fill="none" id="poster-to-send packet" style="stroke:#181818;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#181818" points="464.67,801.292,467.3417,791.8124,463.9549,796.3434,459.4239,792.9566,464.67,801.292" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="49" x="165" y="524.612">channel</text></g><!--MD5=[d146aff062c6c9cbaf209dcc0f03b086]
link push to handlePush--><g id="link_push_handlePush"><path d="M77.29,258.852 C74.45,310.082 71.78,432.302 102,528.532 C118.05,579.662 130.84,589.672 163,632.532 C176.21,650.132 184.41,650.482 197,668.532 C226.04,710.172 250.35,764.202 263.77,796.792 " fill="none" id="push-to-handlePush" style="stroke:#181818;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#181818" points="265.67,801.442,265.9527,791.5972,263.7713,796.8165,258.5519,794.6351,265.67,801.442" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="49" x="103" y="524.612">channel</text></g><!--MD5=[9982253eab351c5128528b4c63e1b587]
reverse link push notify to handlePush--><g id="link_push notify_handlePush"><path d="M613.76,796.442 C604.93,762.452 585.17,708.742 545,684.532 C472.68,640.942 427.91,641.922 355,684.532 C311.76,709.802 290.07,768.012 280.8,801.532 " fill="none" id="push notify-backto-handlePush" style="stroke:#181818;stroke-width:1.0;stroke-dasharray:7.0,7.0;"/><polygon fill="#181818" points="614.99,801.302,616.681,791.5994,613.774,796.4521,608.9212,793.5451,614.99,801.302" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="49" x="437.5" y="656.612">channel</text></g><!--MD5=[c311c2052faa7e395e90c0592415fb94]
reverse link storage to forward message--><g id="link_storage_forward message"><path d="M774.0129,306.9263 C774.3587,307.4667 774.7111,308.0023 775.0703,308.5327 C775.7886,309.5935 776.534,310.6336 777.3075,311.6502 C780.4013,315.7165 783.9438,319.4057 788,322.532 C857.64,376.202 1122.73,293.592 1182,358.532 C1232.94,414.332 1213.24,459.742 1182,528.532 C1152.96,592.482 1126.21,601.892 1063,632.532 C984.48,670.592 940.02,616.462 870,668.532 C825.45,701.662 803.41,766.422 794.31,801.532 " fill="none" id="storage-backto-forward message" style="stroke:#181818;stroke-width:1.0;"/><polygon fill="#181818" points="774.0129,306.9263,775.4947,316.6631,776.7079,311.1378,782.2331,312.351,774.0129,306.9263" style="stroke:#181818;stroke-width:1.0;"/></g><!--MD5=[f4bd4ea3246d1929c10ebc1ef11104f7]
@startuml gochat-server-uml
package "Server" {
    frame "main" {
        [signalHandler] as signal
        [handlePush] as handlePush
        [handleConn] as handleConn
        frame "sendTo" {
            [send packet]
            [push notify]
            [forward message]
        }
        [recvFrom] as recvFrom
    }
    frame "poster"
    frame "push"
    frame "storage" {
        database "sqlite" {
            [Account] as acc
            [Message] as msg
        }
    }
    frame "auth"

    folder "biz" {
        [base] as base
        [signup] as signup
        [signin] as signin
        [val-token] as valtoken
        [users] as users
        [recv-msg] as recvmsg
        [ping] as ping
        [signout] as signout
    }
}
signup .up.> base
signin .up.> base
valtoken .up.> base
users .up.> base
recvmsg .up.> base
ping .up.> base
signout .up.> base

valtoken -up-> auth : parse/generate token
signup -up-> auth : generate token
signin -up-> auth : generate token

base -up-> poster : send packet to client
base -up-> push : push notify to client
base -up-> storage

recvFrom -up-> signup
recvFrom -up-> signin
recvFrom -up-> valtoken
recvFrom -up-> users
recvFrom -up-> recvmsg
recvFrom -up-> ping
recvFrom -up-> signout

handleConn .up.> sendTo
handleConn .up.> recvFrom

poster ..> [send packet] : channel
push ..> handlePush : channel
handlePush .left.> [push notify] : channel
[forward message] -left-> storage
@enduml

PlantUML version 1.2022.7(Tue Aug 23 01:01:30 CST 2022)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Default Encoding: UTF-8
Language: zh
Country: CN
--></g></svg>